<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindlytics Laravel Deployment Guide</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Calibri, 'Helvetica Neue', Arial, sans-serif;
            font-size: 11pt;
            line-height: 1.5;
            max-width: 21cm;
            margin: 0 auto;
            padding: 1.5cm 1.2cm;
            color: #1a1a1a;
            background: #fff;
        }
        h1 {
            font-size: 22pt;
            font-weight: 700;
            margin: 0 0 0.3em 0;
            color: #0f172a;
            border-bottom: 2px solid #2563eb;
            padding-bottom: 0.25em;
        }
        h2 {
            font-size: 16pt;
            font-weight: 600;
            margin: 1.2em 0 0.4em 0;
            color: #1e40af;
        }
        h3 {
            font-size: 13pt;
            font-weight: 600;
            margin: 0.9em 0 0.3em 0;
            color: #334155;
        }
        p {
            margin: 0.4em 0;
        }
        .subtitle {
            font-size: 12pt;
            color: #475569;
            margin-bottom: 1em;
        }
        .code, code {
            font-family: Consolas, 'Courier New', monospace;
            font-size: 10pt;
            background: #f1f5f9;
            padding: 0.35em 0.6em;
            border-radius: 4px;
            border: 1px solid #e2e8f0;
            display: block;
            margin: 0.25em 0 0.5em 0.8em;
            overflow-x: auto;
        }
        .note {
            background: #fef3c7;
            padding: 0.6em 0.9em;
            border-left: 4px solid #f59e0b;
            margin: 0.6em 0;
            font-size: 10.5pt;
        }
        .note strong { color: #b45309; }
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0.8em 0;
            font-size: 10.5pt;
        }
        .summary-table th,
        .summary-table td {
            border: 1px solid #cbd5e1;
            padding: 0.5em 0.7em;
            text-align: left;
        }
        .summary-table th {
            background: #e2e8f0;
            font-weight: 600;
        }
        .summary-table tr:nth-child(even) { background: #f8fafc; }
        ol, ul { margin: 0.4em 0; padding-left: 1.5em; }
        li { margin: 0.2em 0; }
        .step-num { font-weight: 600; color: #1e40af; }
    </style>
</head>
<body>

<h1>Mindlytics Laravel Deployment Guide</h1>
<p class="subtitle"><strong>Git-based workflow:</strong> Local → GitHub → Server</p>
<p>This guide covers updating the project locally, pushing to GitHub, and deploying changes on the server.</p>

<h2>1. Local (Offline) Updates</h2>
<p>Open your Laravel project on your computer. After making any changes:</p>
<ol>
    <li><span class="step-num">Stage and commit:</span></li>
</ol>
<code>git add .<br>git commit -m "Brief description of the update"</code>
<ol start="2">
    <li><span class="step-num">Push to GitHub:</span></li>
</ol>
<code>git push origin main</code>
<p>If your default branch is <code>master</code> instead of <code>main</code>, use: <code>git push origin master</code>.</p>
<div class="note"><strong>Important:</strong> Never add the <code>.env</code> file to GitHub. It should be in <code>.gitignore</code> because it contains sensitive data (database credentials, keys, etc.).</div>

<h2>2. Server Access & Pulling Updates</h2>

<h3>2.1 Connect to the server</h3>
<p>SSH into your server and go to the project directory:</p>
<code>ssh username@your-server-ip<br>cd /path/to/Mindlytics</code>

<h3>2.2 Verify Git remote</h3>
<p>Check that the project is linked to GitHub:</p>
<code>git remote -v</code>
<p>If it is not connected, run:</p>
<code>git init<br>git remote add origin https://github.com/mohamedhany-web/mindlytics.git</code>

<h3>2.3 Pull latest code from GitHub</h3>
<p>Fetch and reset to match the remote branch exactly:</p>
<code>git fetch origin<br>git reset --hard origin/main</code>
<p>Using <code>reset --hard</code> ensures all project files match the latest version on GitHub. Your <code>.env</code> on the server is not tracked by Git, so it will not be overwritten.</p>

<h2>3. The .env File on the Server</h2>
<p>Do not delete or overwrite the <code>.env</code> file on the server.</p>
<p>After each update, verify that database connection values are correct:</p>
<ul>
    <li>DB_HOST</li>
    <li>DB_DATABASE</li>
    <li>DB_USERNAME</li>
    <li>DB_PASSWORD</li>
</ul>
<p>You usually only need to edit <code>.env</code> when you add new configuration options to the project.</p>

<h2>4. Update Composer Dependencies</h2>
<p>If you added or changed PHP packages (<code>composer.json</code>), run on the server:</p>
<code>composer install --no-dev --optimize-autoloader</code>
<p>Use <code>--no-dev</code> in production to avoid installing development-only packages.</p>

<h2>5. Database Migrations</h2>
<p>If there are new or changed migrations (or seeders), run:</p>
<code>php artisan migrate --force</code>
<p>The <code>--force</code> flag is required in production to skip confirmation prompts.</p>

<h2>6. Clear and Rebuild Cache</h2>
<p>Laravel caches config, routes, and views. After every deployment run:</p>
<code>php artisan config:cache<br>php artisan route:cache<br>php artisan view:cache</code>
<p>This ensures changes take effect immediately and improves performance.</p>

<h2>7. Workflow Summary</h2>
<p>Quick reference for the full deployment flow.</p>
<table class="summary-table">
    <thead>
        <tr><th>Step</th><th>Action</th></tr>
    </thead>
    <tbody>
        <tr><td>Local</td><td>Edit code → git add . → git commit -m "..." → git push origin main</td></tr>
        <tr><td>Server</td><td>git fetch origin && git reset --hard origin/main</td></tr>
        <tr><td>Packages</td><td>composer install --no-dev --optimize-autoloader (if needed)</td></tr>
        <tr><td>Database</td><td>php artisan migrate --force (if there are new migrations)</td></tr>
        <tr><td>Cache</td><td>php artisan config:cache && route:cache && view:cache</td></tr>
        <tr><td>.env</td><td>Keep server .env as-is; never commit it to GitHub.</td></tr>
    </tbody>
</table>
<div class="note"><strong>Important:</strong> Keep .env only on the server and never add it to GitHub.</div>

</body>
</html>